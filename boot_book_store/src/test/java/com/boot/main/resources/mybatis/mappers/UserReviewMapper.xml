<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.boot.dao.UserReviewDAO">

	<insert id="insertReview" parameterType="com.boot.dto.UserReviewDTO">
		INSERT INTO UserReview (
		review_id,
		user_id,
		user_nickname,
		book_id,
		review_rating,
		review_content,
		review_date
		) VALUES (
		USERREVIEW_SEQ.NEXTVAL,
		#{user_id},
		#{user_nickname, jdbcType=VARCHAR},
		#{book_id},
		#{review_rating},
		#{review_content},
		SYSDATE
		)
	</insert>


	<select id="selectReviewById" resultType="com.boot.dto.UserReviewDTO">
		SELECT review_id, user_id, book_id, review_rating, review_content,
		review_date
		FROM UserReview
		WHERE review_id = #{reviewId}
	</select>

	<select id="findReviewsByBookId" parameterType="long"
		resultType="com.boot.dto.UserReviewDTO">
		SELECT review_id, user_id, user_nickname, book_id, review_rating,
		review_content, review_date
		FROM UserReview
		WHERE book_id = #{bookId}
		ORDER BY review_date DESC
	</select>

	<select id="countUserReviewByBook" resultType="int">
		SELECT COUNT(*) FROM UserReview WHERE user_id = #{userId} AND book_id =
		#{bookId}
	</select>
</mapper>
